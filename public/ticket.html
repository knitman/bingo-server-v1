<!DOCTYPE html>
<html lang="el">
<head>
<meta charset="UTF-8">
<title>ÎšÎ¿Ï…Ï€ÏŒÎ½Î¹ Bingo</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<style>
body{
  font-family:Arial;
  text-align:center;
  padding:20px;
}
#grid{
  display:grid;
  grid-template-columns:repeat(5,1fr);
  gap:10px;
  margin:20px 0;
}
.cell{
  width:60px;
  height:60px;
  border-radius:50%;
  background:#eee;
  display:flex;
  align-items:center;
  justify-content:center;
  font-weight:bold;
}
.marked{background:#ff5252;color:white;}
button{padding:12px 20px;font-size:18px;}
</style>
</head>
<body>

<h2 id="title"></h2>
<div id="grid"></div>
<button onclick="bingo()">BINGO!</button>

<script>
const params=new URLSearchParams(location.search);
const id=params.get("id");

document.getElementById("title").innerText="ÎšÎ¿Ï…Ï€ÏŒÎ½Î¹ #" + id;

let marked=[];

async function load(){
  const res=await fetch("/api/ticket-data?id="+id);
}

const numbers=JSON.parse(atob(params.get("nums")));

const grid=document.getElementById("grid");
numbers.forEach(n=>{
  const d=document.createElement("div");
  d.className="cell";
  d.innerText=n;
  d.onclick=()=>{
    d.classList.toggle("marked");
    if(marked.includes(n)) marked=marked.filter(x=>x!==n);
    else marked.push(n);
  };
  grid.appendChild(d);
});

async function bingo(){
  const res=await fetch("/api/bingo",{
    method:"POST",
    headers:{ "Content-Type":"application/json" },
    body:JSON.stringify({ id, marked })
  });
  const data=await res.json();
  alert(data.win ? "ğŸ‰ BINGO!" : "âŒ Î†ÎºÏ…ÏÎ¿");
}
</script>
</body>
</html>
